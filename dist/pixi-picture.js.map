{"version":3,"file":"pixi-picture.js","sourceRoot":"","sources":["../src/BlendFilter.ts","../src/FilterSystemMixin.ts","../src/MaskFilter.ts","../src/Mesh.ts","../src/ShaderParts.ts","../src/Sprite.ts","../src/TilingSprite.ts","../src/xporter.ts"],"names":[],"mappings":"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","sourcesContent":["namespace pixi_picture {\n    export class BackdropFilter extends PIXI.Filter {\n        backdropUniformName: string = null;\n        _backdropActive: boolean = false;\n        clearColor: Float32Array = null;\n    }\n\n    export interface IBlendShaderParts {\n        uniformCode?: string;\n        uniforms?: { [key: string]: any };\n        blendCode: string;\n    }\n\n    const filterFrag = `\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D uBackdrop;\n\n%UNIFORM_CODE%\n\nvoid main(void)\n{\n   vec4 b_src = texture2D(uSampler, vTextureCoord);\n   vec4 b_dest = texture2D(uBackdrop, vTextureCoord);\n   vec4 b_res = b_dest;\n   \n   %BLEND_CODE%\n\n   gl_FragColor = b_res;\n}`;\n\n    export class BlendFilter extends BackdropFilter {\n        constructor(shaderParts: IBlendShaderParts) {\n            let fragCode = filterFrag;\n            fragCode = fragCode.replace('%UNIFORM_CODE%', shaderParts.uniformCode || \"\");\n            fragCode = fragCode.replace('%BLEND_CODE%', shaderParts.blendCode || \"\");\n\n            super(undefined, fragCode, shaderParts.uniforms);\n\n            this.backdropUniformName = 'uBackdrop';\n        }\n    }\n}","declare namespace PIXI {\n    namespace systems {\n        interface FilterSystem {\n            prepareBackdrop(sourceFrame: PIXI.Rectangle): PIXI.RenderTexture;\n            pushWithCheck(target: PIXI.DisplayObject, filters: Array<Filter>, checkEmptyBounds?: boolean): boolean;\n        }\n\n        interface TextureSystem {\n            bindForceLocation(texture: BaseTexture, location: number): void;\n        }\n    }\n}\n\nnamespace pixi_picture {\n    function containsRect(rectOut: PIXI.Rectangle, rectIn: PIXI.Rectangle): boolean {\n        let r1 = rectIn.x + rectIn.width;\n        let b1 = rectIn.y + rectIn.height;\n        let r2 = rectOut.x + rectOut.width;\n        let b2 = rectOut.y + rectOut.height;\n        return (rectIn.x >= rectOut.x) &&\n            (rectIn.x <= r2) &&\n            (rectIn.y >= rectOut.y) &&\n            (rectIn.y <= b2) &&\n            (r1 >= rectOut.x) &&\n            (r1 <= r2) &&\n            (b1 >= rectOut.y) &&\n            (b1 <= b2);\n    }\n\n    PIXI.systems.TextureSystem.prototype.bindForceLocation = function(texture: PIXI.BaseTexture, location = 0) {\n        const { gl } = this;\n        if (this.currentLocation !== location)\n        {\n            this.currentLocation = location;\n            gl.activeTexture(gl.TEXTURE0 + location);\n        }\n        this.bind(texture, location);\n    }\n\n    function pushWithCheck(this: PIXI.systems.FilterSystem,\n                  target: PIXI.DisplayObject, filters: Array<BackdropFilter>, checkEmptyBounds: boolean = true) {\n        const renderer = this.renderer;\n        const filterStack = this.defaultFilterStack;\n        const state = this.statePool.pop() || new (PIXI as any).FilterState();\n\n        let resolution = filters[0].resolution;\n        let padding = filters[0].padding;\n        let autoFit = filters[0].autoFit;\n        let legacy = filters[0].legacy;\n\n        for (let i = 1; i < filters.length; i++) {\n            const filter = filters[i];\n\n            // lets use the lowest resolution..\n            resolution = Math.min(resolution, filter.resolution);\n            // figure out the padding required for filters\n            padding = this.useMaxPadding\n                // old behavior: use largest amount of padding!\n                ? Math.max(padding, filter.padding)\n                // new behavior: sum the padding\n                : padding + filter.padding;\n            // only auto fit if all filters are autofit\n            autoFit = autoFit || filter.autoFit;\n\n            legacy = legacy || filter.legacy;\n        }\n\n        if (filterStack.length === 1) {\n            this.defaultFilterStack[0].renderTexture = renderer.renderTexture.current;\n        }\n\n        filterStack.push(state);\n\n        state.resolution = resolution;\n\n        state.legacy = legacy;\n\n        state.target = target;\n\n        state.sourceFrame.copyFrom(target.filterArea || target.getBounds(true));\n\n        let canUseBackdrop = true;\n        state.sourceFrame.pad(padding);\n        if (autoFit) {\n            state.sourceFrame.fit(this.renderer.renderTexture.sourceFrame);\n        } else {\n            canUseBackdrop = containsRect(this.renderer.renderTexture.sourceFrame, state.sourceFrame);\n        }\n        if (checkEmptyBounds && state.sourceFrame.width <= 1 && state.sourceFrame.height <= 1) {\n            filterStack.pop();\n            state.clear();\n            this.statePool.push(state);\n            return false;\n        }\n\n        // round to whole number based on resolution\n        state.sourceFrame.ceil(resolution);\n\n        // detect backdrop uniform\n        if (canUseBackdrop) {\n            let backdrop = null;\n            for (let i = 0; i < filters.length; i++) {\n                const bName = filters[i].backdropUniformName;\n                if (bName) {\n                    if (backdrop === null) {\n                        backdrop = this.prepareBackdrop(state.sourceFrame);\n                    }\n\n                    filters[i].uniforms[bName] = backdrop;\n                    if (backdrop) {\n                        filters[i]._backdropActive = true;\n                    }\n                }\n            }\n        }\n\n        state.renderTexture = this.getOptimalFilterTexture(state.sourceFrame.width, state.sourceFrame.height, resolution);\n        state.filters = filters;\n\n        state.destinationFrame.width = state.renderTexture.width;\n        state.destinationFrame.height = state.renderTexture.height;\n\n        const destinationFrame = this.tempRect;\n\n        destinationFrame.width = state.sourceFrame.width;\n        destinationFrame.height = state.sourceFrame.height;\n\n        state.renderTexture.filterFrame = state.sourceFrame;\n\n        renderer.renderTexture.bind(state.renderTexture, state.sourceFrame, destinationFrame);\n        renderer.renderTexture.clear(filters[filters.length - 1].clearColor as any);\n\n        return true;\n    }\n\n    function push(this: PIXI.systems.FilterSystem,\n                  target: PIXI.DisplayObject, filters: Array<PIXI.Filter>) {\n        return this.pushWithCheck(target, filters, false);\n    }\n\n    function pop(this: PIXI.systems.FilterSystem) {\n        const filterStack = this.defaultFilterStack;\n        const state = filterStack.pop();\n        const filters = state.filters;\n\n        this.activeState = state;\n\n        const globalUniforms = this.globalUniforms.uniforms;\n\n        globalUniforms.outputFrame = state.sourceFrame;\n        globalUniforms.resolution = state.resolution;\n\n        const inputSize = globalUniforms.inputSize;\n        const inputPixel = globalUniforms.inputPixel;\n        const inputClamp = globalUniforms.inputClamp;\n\n        inputSize[0] = state.destinationFrame.width;\n        inputSize[1] = state.destinationFrame.height;\n        inputSize[2] = 1.0 / inputSize[0];\n        inputSize[3] = 1.0 / inputSize[1];\n\n        inputPixel[0] = inputSize[0] * state.resolution;\n        inputPixel[1] = inputSize[1] * state.resolution;\n        inputPixel[2] = 1.0 / inputPixel[0];\n        inputPixel[3] = 1.0 / inputPixel[1];\n\n        inputClamp[0] = 0.5 * inputPixel[2];\n        inputClamp[1] = 0.5 * inputPixel[3];\n        inputClamp[2] = (state.sourceFrame.width * inputSize[2]) - (0.5 * inputPixel[2]);\n        inputClamp[3] = (state.sourceFrame.height * inputSize[3]) - (0.5 * inputPixel[3]);\n\n        // only update the rect if its legacy..\n        if (state.legacy)\n        {\n            const filterArea = globalUniforms.filterArea;\n\n            filterArea[0] = state.destinationFrame.width;\n            filterArea[1] = state.destinationFrame.height;\n            filterArea[2] = state.sourceFrame.x;\n            filterArea[3] = state.sourceFrame.y;\n\n            globalUniforms.filterClamp = globalUniforms.inputClamp;\n        }\n\n        (this.globalUniforms as any).update();\n\n        const lastState = filterStack[filterStack.length - 1];\n\n        if (state.renderTexture.framebuffer.multisample > 1)\n        {\n            this.renderer.framebuffer.blit();\n        }\n\n        if (filters.length === 1)\n        {\n            filters[0].apply(this, state.renderTexture, lastState.renderTexture, PIXI.CLEAR_MODES.BLEND, state);\n\n            this.returnFilterTexture(state.renderTexture);\n        }\n        else\n        {\n            let flip = state.renderTexture;\n            let flop = this.getOptimalFilterTexture(\n                flip.width,\n                flip.height,\n                state.resolution\n            );\n\n            (flop as any).filterFrame = flip.filterFrame;\n\n            let i = 0;\n\n            for (i = 0; i < filters.length - 1; ++i)\n            {\n                filters[i].apply(this, flip, flop, PIXI.CLEAR_MODES.CLEAR, state);\n\n                const t = flip;\n\n                flip = flop;\n                flop = t;\n            }\n\n            filters[i].apply(this, flip, lastState.renderTexture, PIXI.CLEAR_MODES.BLEND, state);\n\n            this.returnFilterTexture(flip);\n            this.returnFilterTexture(flop);\n        }\n\n        let backdropFree = false;\n\n        for (let i = 0; i < filters.length; i++) {\n            if (filters[i]._backdropActive) {\n                const bName = filters[i].backdropUniformName;\n                if (!backdropFree) {\n                    this.returnFilterTexture(filters[i].uniforms[bName]);\n                    backdropFree = true;\n                }\n                filters[i].uniforms[bName] = null;\n                filters[i]._backdropActive = false;\n            }\n        }\n\n        state.clear();\n        this.statePool.push(state);\n    }\n\n    let hadBackbufferError = false;\n\n    /**\n     * Takes a part of current render target corresponding to bounds\n     * fits sourceFrame to current render target frame to evade problems\n     */\n    function prepareBackdrop(bounds: PIXI.Rectangle): PIXI.RenderTexture {\n        const renderer = this.renderer;\n        const renderTarget = renderer.renderTexture.current;\n        const fr = this.renderer.renderTexture.sourceFrame;\n\n        if (!renderTarget) {\n            if (!hadBackbufferError) {\n                hadBackbufferError = true;\n                console.warn('pixi-picture: you are trying to use Blend Filter on main framebuffer! That wont work.');\n            }\n            return null;\n        }\n\n        const resolution = renderTarget.baseTexture.resolution;\n\n        //bounds.fit(fr);\n\n        const x = (bounds.x - fr.x) * resolution;\n        const y = (bounds.y - fr.y) * resolution;\n        const w = (bounds.width) * resolution;\n        const h = (bounds.height) * resolution;\n\n        const gl = renderer.gl;\n        const rt = this.getOptimalFilterTexture(w, h, 1);\n\n        rt.filterFrame = fr;\n        renderer.texture.bindForceLocation(rt.baseTexture, 0);\n        gl.copyTexSubImage2D(gl.TEXTURE_2D, 0, 0, 0, x, y, w, h);\n\n        return rt;\n    }\n\n    PIXI.systems.FilterSystem.prototype.push = push;\n    PIXI.systems.FilterSystem.prototype.pushWithCheck = pushWithCheck as any;\n    PIXI.systems.FilterSystem.prototype.pop = pop;\n    PIXI.systems.FilterSystem.prototype.prepareBackdrop = prepareBackdrop;\n}\n","namespace pixi_picture {\n    export enum MASK_CHANNEL {\n        RED = 0,\n        GREEN,\n        BLUE,\n        ALPHA\n    }\n\n    export class MaskConfig {\n        constructor(public maskBefore = false, channel: MASK_CHANNEL = MASK_CHANNEL.ALPHA) {\n            this.uniforms.uChannel[channel] = 1.0;\n        }\n        uniformCode = 'uniform vec4 uChannel;';\n        uniforms: any = {\n            uChannel: new Float32Array([0, 0, 0, 0]), // shared uniform for all those shaders? ok, just set it before apply\n        };\n        blendCode = `b_res = dot(b_src, uChannel) * b_dest;`;\n    }\n\n    export class MaskFilter extends BlendFilter {\n        constructor(public baseFilter: PIXI.Filter, public config = new MaskConfig()) {\n            super(config);\n            this.padding = baseFilter.padding;\n        }\n\n        apply(filterManager: PIXI.systems.FilterSystem, input: PIXI.RenderTexture, output: PIXI.RenderTexture,\n              clearMode: PIXI.CLEAR_MODES) {\n            const target = filterManager.getFilterTexture(input);\n            if (this.config.maskBefore) {\n                const {blendMode} = this.state;\n                this.state.blendMode = PIXI.BLEND_MODES.NONE;\n                filterManager.applyFilter(this, input, target, PIXI.CLEAR_MODES.YES);\n                this.baseFilter.blendMode = blendMode;\n                this.baseFilter.apply(filterManager, target, output, clearMode);\n                this.state.blendMode = blendMode;\n            } else {\n                const {uBackdrop} = this.uniforms;\n                this.baseFilter.apply(filterManager, uBackdrop, target, PIXI.CLEAR_MODES.YES);\n                this.uniforms.uBackdrop = target;\n                filterManager.applyFilter(this, input, output, clearMode);\n                this.uniforms.uBackdrop = uBackdrop;\n            }\n            filterManager.returnFilterTexture(target);\n        }\n    }\n}","namespace pixi_picture {\n    export class Mesh extends PIXI.Mesh {\n\n        //protected _render(renderer: Renderer): void\n        //    {\n        //        this.calculateVertices();\n        //        renderer.batch.setObjectRenderer(renderer.plugins[this.pluginName]);\n        //        renderer.plugins[this.pluginName].render(this);\n        //    }\n\n        //_render(renderer: PIXI.Renderer): void\n        //{\n        //    const texture = (this as any)._texture;\n\n        //    if (!texture || !texture.valid)\n        //    {\n        //        return;\n        //    }\n\n\n        //    const blendFilterArray = getBlendFilterArray(this.blendMode);\n\n        //    if (blendFilterArray) {\n        //        renderer.batch.flush();\n        //        if (!renderer.filter.pushWithCheck(this, blendFilterArray)) {\n        //            return;\n        //        }\n        //    }\n\n        //    this.calculateVertices();\n        //    renderer.batch.setObjectRenderer(renderer.plugins[this.pluginName]);\n        //    renderer.plugins[this.pluginName].render(this);\n\n        //    if (blendFilterArray) {\n        //        renderer.batch.flush();\n        //        renderer.filter.pop();\n        //    }\n        //},\n\n        _render(renderer: PIXI.Renderer): void\n            {\n                const texture = (this as any)._texture;\n\n                if (!texture || !texture.valid)\n                {\n                    return;\n                }\n\n\n                const blendFilterArray = getBlendFilterArray(this.blendMode);\n\n                if (blendFilterArray) {\n                    renderer.batch.flush();\n                    if (!renderer.filter.pushWithCheck(this, blendFilterArray)) {\n                        return;\n                    }\n                }\n\n                // set properties for batching..\n                // TODO could use a different way to grab verts?\n                //const vertices = this.geometry.buffers[0].data;\n                const vertices = this.verticesBuffer.data\n                // TODO benchmark check for attribute size..\n                if ( true\n                    //this.shader.batchable\n                    //this.drawMode === PIXI.DRAW_MODES.TRIANGLES\n                    //&& vertices.length < Mesh.BATCHABLE_SIZE * 2\n                )\n                {\n                    this._renderToBatch(renderer);\n                }\n                else\n                {\n                    this._renderDefault(renderer);\n                }\n\n\n                if (blendFilterArray) {\n                    renderer.batch.flush();\n                    renderer.filter.pop();\n                }\n            }\n    }\n}\n","namespace pixi_picture {\n    export namespace blends {\n        export const NPM_BLEND =\n            `if (b_src.a == 0.0) {\n    gl_FragColor = vec4(0, 0, 0, 0);\n    return;\n}\nvec3 Cb = b_src.rgb / b_src.a, Cs;\nif (b_dest.a > 0.0) {\n    Cs = b_dest.rgb / b_dest.a;\n}\n%NPM_BLEND%\nb_res.a = b_src.a + b_dest.a * (1.0-b_src.a);\nb_res.rgb = (1.0 - b_src.a) * Cs + b_src.a * B;\nb_res.rgb *= b_res.a;\n`;\n\n        //reverse hardlight\n        export const OVERLAY_PART =\n            `vec3 multiply = Cb * Cs * 2.0;\nvec3 Cb2 = Cb * 2.0 - 1.0;\nvec3 screen = Cb2 + Cs - Cb2 * Cs;\nvec3 B;\nif (Cs.r <= 0.5) {\n    B.r = multiply.r;\n} else {\n    B.r = screen.r;\n}\nif (Cs.g <= 0.5) {\n    B.g = multiply.g;\n} else {\n    B.g = screen.g;\n}\nif (Cs.b <= 0.5) {\n    B.b = multiply.b;\n} else {\n    B.b = screen.b;\n}\n`;\n\n        export const HARDLIGHT_PART =\n            `vec3 multiply = Cb * Cs * 2.0;\nvec3 Cs2 = Cs * 2.0 - 1.0;\nvec3 screen = Cb + Cs2 - Cb * Cs2;\nvec3 B;\nif (Cb.r <= 0.5) {\n    B.r = multiply.r;\n} else {\n    B.r = screen.r;\n}\nif (Cb.g <= 0.5) {\n    B.g = multiply.g;\n} else {\n    B.g = screen.g;\n}\nif (Cb.b <= 0.5) {\n    B.b = multiply.b;\n} else {\n    B.b = screen.b;\n}\n`;\n\n        export const SOFTLIGHT_PART =\n            `vec3 first = Cb - (1.0 - 2.0 * Cs) * Cb * (1.0 - Cb);\nvec3 B;\nvec3 D;\nif (Cs.r <= 0.5)\n{\n    B.r = first.r;\n}\nelse\n{\n    if (Cb.r <= 0.25)\n    {\n        D.r = ((16.0 * Cb.r - 12.0) * Cb.r + 4.0) * Cb.r;    \n    }\n    else\n    {\n        D.r = sqrt(Cb.r);\n    }\n    B.r = Cb.r + (2.0 * Cs.r - 1.0) * (D.r - Cb.r);\n}\nif (Cs.g <= 0.5)\n{\n    B.g = first.g;\n}\nelse\n{\n    if (Cb.g <= 0.25)\n    {\n        D.g = ((16.0 * Cb.g - 12.0) * Cb.g + 4.0) * Cb.g;    \n    }\n    else\n    {\n        D.g = sqrt(Cb.g);\n    }\n    B.g = Cb.g + (2.0 * Cs.g - 1.0) * (D.g - Cb.g);\n}\nif (Cs.b <= 0.5)\n{\n    B.b = first.b;\n}\nelse\n{\n    if (Cb.b <= 0.25)\n    {\n        D.b = ((16.0 * Cb.b - 12.0) * Cb.b + 4.0) * Cb.b;    \n    }\n    else\n    {\n        D.b = sqrt(Cb.b);\n    }\n    B.b = Cb.b + (2.0 * Cs.b - 1.0) * (D.b - Cb.b);\n}\n`;\n\n        export const MULTIPLY_FULL =\n            `if (dest.a > 0.0) {\n   b_res.rgb = (dest.rgb / dest.a) * ((1.0 - src.a) + src.rgb);\n   b_res.a = min(src.a + dest.a - src.a * dest.a, 1.0);\n   b_res.rgb *= mult.a;\n}\n`;\n        export const OVERLAY_FULL = NPM_BLEND.replace(`%NPM_BLEND%`, OVERLAY_PART);\n        export const HARDLIGHT_FULL = NPM_BLEND.replace(`%NPM_BLEND%`, HARDLIGHT_PART);\n        export const SOFTLIGHT_FULL = NPM_BLEND.replace(`%NPM_BLEND%`, SOFTLIGHT_PART);\n\n        export const blendFullArray: Array<string> = [];\n\n        blendFullArray[PIXI.BLEND_MODES.MULTIPLY] = MULTIPLY_FULL;\n        blendFullArray[PIXI.BLEND_MODES.OVERLAY] = OVERLAY_FULL;\n        blendFullArray[PIXI.BLEND_MODES.HARD_LIGHT] = HARDLIGHT_FULL;\n        blendFullArray[PIXI.BLEND_MODES.SOFT_LIGHT] = SOFTLIGHT_FULL;\n    }\n\n    let filterCache: Array<BlendFilter> = [];\n    let filterCacheArray: Array<Array<BlendFilter>> = [];\n\n    export function getBlendFilter(blendMode: PIXI.BLEND_MODES) {\n        if (!blends.blendFullArray[blendMode]) {\n            return null;\n        }\n        if (!filterCache[blendMode]) {\n            filterCache[blendMode] = new BlendFilter({blendCode: blends.blendFullArray[blendMode]});\n        }\n        return filterCache[blendMode];\n    }\n\n    export function getBlendFilterArray(blendMode: PIXI.BLEND_MODES) {\n        if (!blends.blendFullArray[blendMode]) {\n            return null;\n        }\n        if (!filterCacheArray[blendMode]) {\n            filterCacheArray[blendMode] = [this.getBlendFilter(blendMode)];\n        }\n        return filterCacheArray[blendMode];\n    }\n}","namespace pixi_picture {\n    export class Sprite extends PIXI.Sprite {\n        _render(renderer: PIXI.Renderer): void\n        {\n            const texture = (this as any)._texture;\n\n            if (!texture || !texture.valid)\n            {\n                return;\n            }\n\n\n            const blendFilterArray = getBlendFilterArray(this.blendMode);\n\n            if (blendFilterArray) {\n                renderer.batch.flush();\n                if (!renderer.filter.pushWithCheck(this, blendFilterArray)) {\n                    return;\n                }\n            }\n\n            this.calculateVertices();\n            renderer.batch.setObjectRenderer(renderer.plugins[this.pluginName]);\n            renderer.plugins[this.pluginName].render(this);\n\n            if (blendFilterArray) {\n                renderer.batch.flush();\n                renderer.filter.pop();\n            }\n        }\n    }\n}\n","namespace pixi_picture {\n    export class TilingSprite extends PIXI.TilingSprite {\n        _render(renderer: PIXI.Renderer): void\n        {\n            // tweak our texture temporarily..\n            const texture = (this as any)._texture;\n\n            if (!texture || !texture.valid)\n            {\n                return;\n            }\n\n            const blendFilterArray = getBlendFilterArray(this.blendMode);\n\n            if (blendFilterArray) {\n                renderer.batch.flush();\n                if (!renderer.filter.pushWithCheck(this, blendFilterArray)) {\n                    return;\n                }\n            }\n\n            this.tileTransform.updateLocalTransform();\n            this.uvMatrix.update();\n\n            renderer.batch.setObjectRenderer(renderer.plugins[this.pluginName]);\n            renderer.plugins[this.pluginName].render(this);\n\n            if (blendFilterArray) {\n                renderer.batch.flush();\n                renderer.filter.pop();\n            }\n        }\n    }\n}\n","/// <reference types=\"pixi.js\" />\nnamespace pixi_picture {\n\t(PIXI as any).picture = pixi_picture;\n}\n"]}